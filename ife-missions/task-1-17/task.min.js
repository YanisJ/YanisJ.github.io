function $(t,a){return a?a.querySelector(t):document.querySelector(t)}function getType(t){return Object.prototype.toString.call(t).match(/\s(.+)\]/)[1].toLowerCase()}function css(t,a,e){if(!t.nodeType)return null;var r;{if("object"!==getType(a))return e?("function"===getType(e)&&(r=!0),void(t.style[a]=r?e(t,css(t,a)):e)):t.currentStyle?t.currentStyle[a]:getComputedStyle(t)[a];for(var n in a)a.hasOwnProperty(n)&&css(t,n,a[n])}}function getDateStr(t){var a=t.getFullYear(),e=t.getMonth()+1;e=10>e?"0"+e:e;var r=t.getDate();return r=10>r?"0"+r:r,a+"-"+e+"-"+r}function randomBuildData(t){for(var a={},e=new Date("2016-01-01"),r="",n=1;92>n;n++)r=getDateStr(e),a[r]=Math.ceil(Math.random()*t),e.setDate(e.getDate()+1);return a}function renderChart(){function t(){switch(pageState.nowGraTime){case"day":return 10;case"week":return 50;case"month":return 150}}function a(t){return 50>=t?"#6eb720":100>=t?"#d6c60f":150>=t?"#ec7e22":200>=t?"#df2d00":300>=t?"#b414bb":"#000"}var e,r=$(".aqi-chart-wrap");r.innerHTML="";var n=document.createElement("div");r.appendChild(n);for(e in chartData)if(chartData.hasOwnProperty(e)){var i=document.createElement("span");css(i,{display:"inline-block",width:t()+"px",height:chartData[e]+"px",background:a(chartData[e]),marginRight:"1px"}),i.title=e,n.appendChild(i)}}function graTimeChange(t){var a;if("input"===t.target.tagName.toLowerCase()){if(a=t.target.value,pageState.nowGraTime===a)return;pageState.nowGraTime=a,chartData=setAqiChartData(),renderChart()}}function citySelectChange(t){var a=parseInt(t.target.value);a!==pageState.nowSelectCity&&(pageState.nowSelectCity=a,chartData=setAqiChartData(),renderChart())}function initGraTimeForm(){$("#form-gra-time").addEventListener("click",graTimeChange)}function initCitySelector(){var t="",a=$("#city-select"),e=Object.keys(aqiSourceData);e.forEach(function(a,e){t+="<option value="+e+">"+a+"</option>"}),a.innerHTML=t,a.addEventListener("change",citySelectChange)}function setAqiChartData(){function t(){return-1===pageState.nowSelectCity?"":Object.keys(aqiSourceData)[pageState.nowSelectCity]}function a(t){var a,e,r,n,i,o={},c=Object.keys(t),u=[31,29,31];switch(pageState.nowGraTime){case"week":for(r=Math.ceil(c.length/7),a=0;r>a;a++){for(n=0,e=7*a;7*(a+1)>e;e++)n+=t[c[e]];o["week"+(a+1)]=Math.floor(n/7)}break;case"month":u.forEach(function(a,e){i=c.splice(0,a),n=0,i.forEach(function(a){n+=t[a]}),o[e+1+"月"]=Math.floor(n/a)});break;default:o=t}return o}var e=aqiSourceData[t()];return e=a(e),e||{}}function initAqiChartData(){chartData=setAqiChartData()}function init(){initGraTimeForm(),initCitySelector(),initAqiChartData()}var aqiSourceData={"北京":randomBuildData(500),"上海":randomBuildData(300),"广州":randomBuildData(200),"深圳":randomBuildData(100),"成都":randomBuildData(300),"西安":randomBuildData(500),"福州":randomBuildData(100),"厦门":randomBuildData(100),"沈阳":randomBuildData(500)},chartData={},pageState={nowSelectCity:0,nowGraTime:"day"};window.onload=init;